import{s as j,o as X,n as E,f as A,h as F}from"../chunks/scheduler.1f6706a1.js";import{S as B,i as J,g,h as k,j as b,f as d,k as p,a as w,t as I,b as K,d as D,p as L,z as Q,s as $,r as P,x as M,c as y,u as S,y as v,v as V,w as q,m as O,n as T,o as U}from"../chunks/index.5dc5c8e5.js";import{e as G}from"../chunks/each.e59479a4.js";import{P as z,h as R}from"../chunks/Pokemon.71d03e80.js";function H(c,e,s){const t=c.slice();return t[6]=e[s],t[8]=s,t}function W(c){let e,s=G(c[4]),t=[];for(let r=0;r<s.length;r+=1)t[r]=N(H(c,s,r));return{c(){e=g("div");for(let r=0;r<t.length;r+=1)t[r].c();this.h()},l(r){e=k(r,"DIV",{class:!0});var i=b(e);for(let l=0;l<t.length;l+=1)t[l].l(i);i.forEach(d),this.h()},h(){p(e,"class","fighters-wrapper svelte-u34pdy")},m(r,i){w(r,e,i);for(let l=0;l<t.length;l+=1)t[l]&&t[l].m(e,null)},p(r,i){if(i&19){s=G(r[4]);let l;for(l=0;l<s.length;l+=1){const u=H(r,s,l);t[l]?t[l].p(u,i):(t[l]=N(u),t[l].c(),t[l].m(e,null))}for(;l<t.length;l+=1)t[l].d(1);t.length=s.length}},i:E,o:E,d(r){r&&d(e),Q(t,r)}}}function Y(c){let e,s,t="Draw !",r,i,l,u,h,a,m="New Fight",f;return i=new z({props:{pokemon:c[4][0]}}),u=new z({props:{pokemon:c[4][1]}}),{c(){e=g("div"),s=g("h1"),s.textContent=t,r=$(),P(i.$$.fragment),l=$(),P(u.$$.fragment),h=$(),a=g("a"),a.textContent=m,this.h()},l(o){e=k(o,"DIV",{class:!0});var n=b(e);s=k(n,"H1",{"data-svelte-h":!0}),M(s)!=="svelte-1z03tk5"&&(s.textContent=t),r=y(n),S(i.$$.fragment,n),l=y(n),S(u.$$.fragment,n),n.forEach(d),h=y(o),a=k(o,"A",{href:!0,class:!0,"data-svelte-h":!0}),M(a)!=="svelte-1dp28qv"&&(a.textContent=m),this.h()},h(){p(e,"class","winner svelte-u34pdy"),p(a,"href","/"),p(a,"class","new-fight svelte-u34pdy")},m(o,n){w(o,e,n),v(e,s),v(e,r),V(i,e,null),v(e,l),V(u,e,null),w(o,h,n),w(o,a,n),f=!0},p:E,i(o){f||(D(i.$$.fragment,o),D(u.$$.fragment,o),f=!0)},o(o){I(i.$$.fragment,o),I(u.$$.fragment,o),f=!1},d(o){o&&(d(e),d(h),d(a)),q(i),q(u)}}}function Z(c){let e,s,t=c[2].name.toUpperCase()+"",r,i,l,u,h,a,m="New Fight",f;return u=new z({props:{pokemon:c[2]}}),{c(){e=g("div"),s=g("h1"),r=O(t),i=O(" wins !"),l=$(),P(u.$$.fragment),h=$(),a=g("a"),a.textContent=m,this.h()},l(o){e=k(o,"DIV",{class:!0});var n=b(e);s=k(n,"H1",{});var _=b(s);r=T(_,t),i=T(_," wins !"),_.forEach(d),l=y(n),S(u.$$.fragment,n),n.forEach(d),h=y(o),a=k(o,"A",{href:!0,class:!0,"data-svelte-h":!0}),M(a)!=="svelte-1dp28qv"&&(a.textContent=m),this.h()},h(){p(e,"class","winner svelte-u34pdy"),p(a,"href","/"),p(a,"class","new-fight svelte-u34pdy")},m(o,n){w(o,e,n),v(e,s),v(s,r),v(s,i),v(e,l),V(u,e,null),w(o,h,n),w(o,a,n),f=!0},p(o,n){(!f||n&4)&&t!==(t=o[2].name.toUpperCase()+"")&&U(r,t);const _={};n&4&&(_.pokemon=o[2]),u.$set(_)},i(o){f||(D(u.$$.fragment,o),f=!0)},o(o){I(u.$$.fragment,o),f=!1},d(o){o&&(d(e),d(h),d(a)),q(u)}}}function N(c){let e,s,t,r,i,l=(c[0][c[8]].hp>0?c[0][c[8]].hp:0)+"",u,h,a,m,f,o;return{c(){e=g("div"),s=g("p"),t=g("img"),i=$(),u=O(l),h=$(),a=g("img"),o=$(),this.h()},l(n){e=k(n,"DIV",{class:!0});var _=b(e);s=k(_,"P",{class:!0});var C=b(s);t=k(C,"IMG",{src:!0,alt:!0,class:!0}),i=y(C),u=T(C,l),C.forEach(d),h=y(_),a=k(_,"IMG",{src:!0,alt:!0,style:!0,class:!0}),o=y(_),_.forEach(d),this.h()},h(){var n;A(t.src,r=R)||p(t,"src",r),p(t,"alt",""),p(t,"class","svelte-u34pdy"),p(s,"class","svelte-u34pdy"),A(a.src,m=c[6].sprites.front_default)||p(a,"src",m),p(a,"alt",""),p(a,"style",c[8]===0?"transform: scaleX(-1);":""),p(a,"class",f=F(`fighter-img ${(n=c[1][c[8]])!=null&&n.hurted?"hurted":""}`)+" svelte-u34pdy"),p(e,"class","figther-wrapper svelte-u34pdy")},m(n,_){w(n,e,_),v(e,s),v(s,t),v(s,i),v(s,u),v(e,h),v(e,a),v(e,o)},p(n,_){var C;_&1&&l!==(l=(n[0][n[8]].hp>0?n[0][n[8]].hp:0)+"")&&U(u,l),_&2&&f!==(f=F(`fighter-img ${(C=n[1][n[8]])!=null&&C.hurted?"hurted":""}`)+" svelte-u34pdy")&&p(a,"class",f)},d(n){n&&d(e)}}}function x(c){let e,s,t,r;const i=[Z,Y,W],l=[];function u(h,a){return h[2]?0:h[3]?1:2}return s=u(c),t=l[s]=i[s](c),{c(){e=g("div"),t.c(),this.h()},l(h){e=k(h,"DIV",{class:!0});var a=b(e);t.l(a),a.forEach(d),this.h()},h(){p(e,"class","main svelte-u34pdy")},m(h,a){w(h,e,a),l[s].m(e,null),r=!0},p(h,[a]){let m=s;s=u(h),s===m?l[s].p(h,a):(L(),I(l[m],1,1,()=>{l[m]=null}),K(),t=l[s],t?t.p(h,a):(t=l[s]=i[s](h),t.c()),D(t,1),t.m(e,null))},i(h){r||(D(t),r=!0)},o(h){I(t),r=!1},d(h){h&&d(e),l[s].d()}}}function ee(c,e,s){let{data:t}=e;const{fighters:r}=t;let i=[{uuid:r[0].uuid,hp:r[0].hp},{uuid:r[1].uuid,hp:r[1].hp}],l=[],u,h=!1;return X(()=>{const a=setInterval(async()=>{r.forEach((m,f)=>{var n;const o=f===0?1:0;s(0,i[o].hp-=Math.floor(Math.random()*m.attack),i),s(1,l[f]={uuid:m.uuid,hurted:!((n=l[f])!=null&&n.hurted)},l)}),i[0].hp<=0?(s(2,u=r[1]),await fetch(`http://localhost:5173/fight?winner=${u.uuid}&loser=${r[0].uuid}`,{method:"POST"})):i[1].hp<=0?(s(2,u=r[0]),await fetch(`http://localhost:5173/fight?winner=${u.uuid}&loser=${r[1].uuid}`,{method:"POST"})):i[0].hp<=0&&i[1].hp<=0&&(s(3,h=!0),await fetch(`http://localhost:5173/fight?&winner=${r[0].uuid}&looser=${r[1].uuid}&isDraw=true`,{method:"POST"})),(i[0].hp<=0||i[1].hp<=0)&&clearInterval(a)},500);return()=>clearInterval(a)}),c.$$set=a=>{"data"in a&&s(5,t=a.data)},[i,l,u,h,r,t]}class ae extends B{constructor(e){super(),J(this,e,ee,x,j,{data:5})}}export{ae as component};
